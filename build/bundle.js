var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function l(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let u,c;function s(t,e){return u||(u=document.createElement("a")),u.href=e,t===u.href}function a(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function p(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function y(){return g(" ")}function _(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t){return""===t?null:+t}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function w(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function k(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function S(t){c=t}const E=[],O=[],q=[],C=[],M=Promise.resolve();let j=!1;function L(t){q.push(t)}let N=!1;const T=new Set;function A(){if(!N){N=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];S(e),B(e.$$)}for(S(null),E.length=0;O.length;)O.pop()();for(let t=0;t<q.length;t+=1){const e=q[t];T.has(e)||(T.add(e),e())}q.length=0}while(E.length);for(;C.length;)C.pop()();j=!1,N=!1,T.clear()}}function B(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const z=new Set;let I;function J(t,e){t&&t.i&&(z.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(z.has(t))return;z.add(t),I.c.push((()=>{z.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function F(t,e){t.d(1),e.delete(t.key)}function H(t,e){D(t,1,1,(()=>{e.delete(t.key)}))}function R(t,e,n,o,l,r,i,u,c,s,a,p){let f=t.length,d=r.length,h=f;const m={};for(;h--;)m[t[h].key]=h;const g=[],y=new Map,_=new Map;for(h=d;h--;){const t=p(l,r,h),u=n(t);let c=i.get(u);c?o&&c.p(t,e):(c=s(u,t),c.c()),y.set(u,g[h]=c),u in m&&_.set(u,Math.abs(h-m[u]))}const v=new Set,b=new Set;function $(t){J(t,1),t.m(u,a),i.set(t.key,t),a=t.first,d--}for(;f&&d;){const e=g[d-1],n=t[f-1],o=e.key,l=n.key;e===n?(a=e.first,f--,d--):y.has(l)?!i.has(o)||v.has(o)?$(e):b.has(l)?f--:_.get(o)>_.get(l)?(b.add(o),$(e)):(v.add(l),f--):(c(n,i),f--)}for(;f--;){const e=t[f];y.has(e.key)||c(e,i)}for(;d;)$(g[d-1]);return g}function P(t,e,o,i){const{fragment:u,on_mount:c,on_destroy:s,after_update:a}=t.$$;u&&u.m(e,o),i||L((()=>{const e=c.map(n).filter(r);s?s.push(...e):l(e),t.$$.on_mount=[]})),a.forEach(L)}function G(t,e){const n=t.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function K(t,e){-1===t.$$.dirty[0]&&(E.push(t),j||(j=!0,M.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(e,n,r,i,u,s,a,p=[-1]){const f=c;S(e);const h=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:u,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:o(),dirty:p,skip_bound:!1,root:n.target||f.$$.root};a&&a(h.root);let m=!1;if(h.ctx=r?r(e,n.props||{},((t,n,...o)=>{const l=o.length?o[0]:n;return h.ctx&&u(h.ctx[t],h.ctx[t]=l)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](l),m&&K(e,t)),n})):[],h.update(),m=!0,l(h.before_update),h.fragment=!!i&&i(h.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);h.fragment&&h.fragment.l(t),t.forEach(d)}else h.fragment&&h.fragment.c();n.intro&&J(e.$$.fragment),P(e,n.target,n.anchor,n.customElement),A()}S(f)}class U{$destroy(){G(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const V=[];function W(e,n=t){let o;const l=new Set;function r(t){if(i(e,t)&&(e=t,o)){const t=!V.length;for(const t of l)t[1](),V.push(t,e);if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,u=t){const c=[i,u];return l.add(c),1===l.size&&(o=n(r)||t),i(e),()=>{l.delete(c),0===l.size&&(o(),o=null)}}}}const X=W({waiting:!0}),Y=W({});fetch("raw-data/item.min.json").then((t=>t.json())).then((t=>{t=t.filter(Boolean).map((t=>(t.context=JSON.stringify(t),t.equipped_by=t.equipped_by?.map((t=>t?.name)),t))),Y.set({types:[...new Set(t.map((t=>t.type)))],tiers:[...new Set(t.map((t=>t.tier)))],equipped_by:[...new Set(t.map((t=>t.equipped_by)).flat().filter(Boolean))]}),X.set(t)}));const Z=function(){const{subscribe:t,set:e,update:n}=W([]);return{subscribe:t,add:t=>n((e=>(e[e.length]={timestamp:t.timestamp,rules:null},e))),update:(t,e)=>n((n=>{let o=n.findIndex((e=>e.timestamp===t));return n[o].rules=e,n})),remove:t=>n((e=>{let n=e.findIndex((e=>e.timestamp===t));return-1!==n&&e.splice(n,1),e})),reset:()=>e([])}}(),tt=[{prop:"name",type:"text"},{prop:"id",type:"number",min:0},{prop:"description",type:"text"},{prop:"type",type:"text",list:"types"},{prop:"tier",type:"number",list:"tiers",min:1,max:10},{prop:"boss",type:"checkbox"},{prop:"arena",type:"checkbox"},{prop:"equipped_by",type:"text",list:"equipped_by"},{prop:"context",type:"text"},{prop:"view_distance",type:"checkbox"}];function et(t,e,n){const o=t.slice();return o[17]=e[n],o}function nt(t,e,n){const o=t.slice();return o[20]=e[n],o}function ot(e){let n,o,l,r=e[20].prop+"";return{c(){n=m("option"),o=g(r),n.__value=l=e[20].prop,n.value=n.__value},m(t,e){f(t,n,e),p(n,o)},p:t,d(t){t&&d(n)}}}function lt(t){let e,n,o;return{c(){e=m("input"),v(e,"type","text")},m(l,r){f(l,e,r),x(e,t[2]),n||(o=_(e,"input",t[14]),n=!0)},p(t,n){44&n&&e.value!==t[2]&&x(e,t[2])},d(t){t&&d(e),n=!1,o()}}}function rt(t){let e,n,o,l,r;return{c(){e=m("input"),v(e,"type","number"),v(e,"min",n=t[3].min),v(e,"max",o=t[3].max)},m(n,o){f(n,e,o),x(e,t[2]),l||(r=_(e,"input",t[13]),l=!0)},p(t,l){8&l&&n!==(n=t[3].min)&&v(e,"min",n),8&l&&o!==(o=t[3].max)&&v(e,"max",o),44&l&&b(e.value)!==t[2]&&x(e,t[2])},d(t){t&&d(e),l=!1,r()}}}function it(t){let e,n,o,l=t[5][t[3].list],r=[];for(let e=0;e<l.length;e+=1)r[e]=ct(et(t,l,e));return{c(){e=m("select");for(let t=0;t<r.length;t+=1)r[t].c();void 0===t[2]&&L((()=>t[12].call(e)))},m(l,i){f(l,e,i);for(let t=0;t<r.length;t+=1)r[t].m(e,null);w(e,t[2]),n||(o=_(e,"change",t[12]),n=!0)},p(t,n){if(40&n){let o;for(l=t[5][t[3].list],o=0;o<l.length;o+=1){const i=et(t,l,o);r[o]?r[o].p(i,n):(r[o]=ct(i),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=l.length}44&n&&w(e,t[2])},d(t){t&&d(e),h(r,t),n=!1,o()}}}function ut(t){let e,n,o,r,i,u,c,s,a;return{c(){e=m("label"),n=g("T\n      "),o=m("input"),r=y(),i=m("label"),u=m("input"),c=g("\n      F"),v(o,"type","radio"),o.__value="1",o.value=o.__value,t[10][0].push(o),v(u,"type","radio"),u.__value="0",u.value=u.__value,t[10][0].push(u)},m(l,d){f(l,e,d),p(e,n),p(e,o),o.checked=o.__value===t[2],f(l,r,d),f(l,i,d),p(i,u),u.checked=u.__value===t[2],p(i,c),s||(a=[_(o,"change",t[9]),_(u,"change",t[11])],s=!0)},p(t,e){44&e&&(o.checked=o.__value===t[2]),44&e&&(u.checked=u.__value===t[2])},d(n){n&&d(e),t[10][0].splice(t[10][0].indexOf(o),1),n&&d(r),n&&d(i),t[10][0].splice(t[10][0].indexOf(u),1),s=!1,l(a)}}}function ct(t){let e,n,o;return{c(){e=m("option"),e.__value=n=t[17],e.value=e.__value,v(e,"label",o=t[17])},m(t,n){f(t,e,n)},p(t,l){40&l&&n!==(n=t[17])&&(e.__value=n,e.value=e.__value),40&l&&o!==(o=t[17])&&v(e,"label",o)},d(t){t&&d(e)}}}function st(t){let e,n,o,l,r,i;return{c(){e=m("select"),n=m("option"),n.textContent="=",o=m("option"),o.textContent="+",l=m("option"),l.textContent="-",n.__value="=",n.value=n.__value,o.__value="+",o.value=o.__value,l.__value="-",l.value=l.__value,void 0===t[1]&&L((()=>t[15].call(e)))},m(u,c){f(u,e,c),p(e,n),p(e,o),p(e,l),w(e,t[1]),r||(i=_(e,"change",t[15]),r=!0)},p(t,n){2&n&&w(e,t[1])},d(t){t&&d(e),r=!1,i()}}}function at(e){let n,o,i,u,c,s,a,b,$,x=tt,k=[];for(let t=0;t<x.length;t+=1)k[t]=ot(nt(e,x,t));function S(t,e){return"checkbox"===t[3].type?ut:t[3].list?it:"number"===t[3].type?rt:"text"===t[3].type?lt:void 0}let E=S(e),O=E&&E(e),q="number"===e[3].type&&st(e);return{c(){n=m("div"),o=m("button"),o.textContent="x",i=y(),u=m("select");for(let t=0;t<k.length;t+=1)k[t].c();c=g("}"),s=y(),O&&O.c(),a=y(),q&&q.c(),void 0===e[4]&&L((()=>e[8].call(u))),v(n,"class","filters")},m(t,l){f(t,n,l),p(n,o),p(n,i),p(n,u);for(let t=0;t<k.length;t+=1)k[t].m(u,null);p(u,c),w(u,e[4]),p(n,s),O&&O.m(n,null),p(n,a),q&&q.m(n,null),b||($=[_(o,"click",(function(){r(e[6](e[0]))&&e[6](e[0]).apply(this,arguments)})),_(u,"change",e[8]),_(u,"change",pt)],b=!0)},p(t,[o]){if(e=t,0&o){let t;for(x=tt,t=0;t<x.length;t+=1){const n=nt(e,x,t);k[t]?k[t].p(n,o):(k[t]=ot(n),k[t].c(),k[t].m(u,c))}for(;t<k.length;t+=1)k[t].d(1);k.length=x.length}16&o&&w(u,e[4]),E===(E=S(e))&&O?O.p(e,o):(O&&O.d(1),O=E&&E(e),O&&(O.c(),O.m(n,a))),"number"===e[3].type?q?q.p(e,o):(q=st(e),q.c(),q.m(n,null)):q&&(q.d(1),q=null)},i:t,o:t,d(t){t&&d(n),h(k,t),O&&O.d(),q&&q.d(),b=!1,l($)}}}function pt(){}function ft(t,e,n){let o,l,r,i,u;a(t,Y,(t=>n(5,u=t)));let{timestamp:c}=e,{rules:s}=e;console.log({filtersDef:tt});return t.$$set=t=>{"timestamp"in t&&n(0,c=t.timestamp),"rules"in t&&n(7,s=t.rules)},t.$$.update=()=>{32&t.$$.dirty&&console.log(1111111,u),16&t.$$.dirty&&n(3,l=tt.find((t=>t.prop===o))),31&t.$$.dirty&&Z.update(c,{prop:o,type:l.type,value:r,comparator:i})},n(4,o="name"),n(2,r=null),n(1,i="="),[c,i,r,l,o,u,function(t){Z.remove(t)},s,function(){o=k(this),n(4,o)},function(){r=this.__value,n(2,r),n(3,l),n(4,o)},[[]],function(){r=this.__value,n(2,r),n(3,l),n(4,o)},function(){r=k(this),n(2,r),n(3,l),n(4,o)},function(){r=b(this.value),n(2,r),n(3,l),n(4,o)},function(){r=this.value,n(2,r),n(3,l),n(4,o)},function(){i=k(this),n(1,i)}]}class dt extends U{constructor(t){super(),Q(this,t,ft,at,i,{timestamp:0,rules:7})}}function ht(t,e,n){const o=t.slice();return o[13]=e[n],o}function mt(t,e,n){const o=t.slice();return o[16]=e[n],o}function gt(t,n){let o,l,r,i;const u=[n[16]];let c={};for(let t=0;t<u.length;t+=1)c=e(c,u[t]);return l=new dt({props:c}),{key:t,first:null,c(){var t;o=m("li"),(t=l.$$.fragment)&&t.c(),r=y(),this.first=o},m(t,e){f(t,o,e),P(l,o,null),p(o,r),i=!0},p(t,e){n=t;const o=4&e?function(t,e){const n={},o={},l={$$scope:1};let r=t.length;for(;r--;){const i=t[r],u=e[r];if(u){for(const t in i)t in u||(o[t]=1);for(const t in u)l[t]||(n[t]=u[t],l[t]=1);t[r]=u}else for(const t in i)l[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(u,[(r=n[16],"object"==typeof r&&null!==r?r:{})]):{};var r;l.$set(o)},i(t){i||(J(l.$$.fragment,t),i=!0)},o(t){D(l.$$.fragment,t),i=!1},d(t){t&&d(o),G(l)}}}function yt(t){let e,n,o,r,i,u,c,s,a,h,w,k,S,E,O,q,C=t[0].length+"",M=[],j=new Map,L=t[0].slice(0,t[4]);const N=t=>t[13].id;for(let e=0;e<L.length;e+=1){let n=ht(t,L,e),o=N(n);j.set(o,M[e]=vt(o,n))}return{c(){e=m("div"),n=m("div"),o=g("auto show image below\n      "),r=m("input"),i=y(),u=m("div"),c=g("items:\n      "),s=m("input"),a=g(" / "),h=g(C),w=y(),k=m("hr"),S=y(),E=m("ul");for(let t=0;t<M.length;t+=1)M[t].c();v(r,"type","number"),v(r,"min","1"),v(r,"max","50"),v(s,"type","number"),v(s,"min","5"),v(s,"max","2000"),v(s,"step","5"),v(e,"class","nav svelte-1x50ec1"),v(E,"class","item-list svelte-1x50ec1")},m(l,d){f(l,e,d),p(e,n),p(n,o),p(n,r),x(r,t[1]),p(e,i),p(e,u),p(u,c),p(u,s),x(s,t[4]),p(u,a),p(u,h),f(l,w,d),f(l,k,d),f(l,S,d),f(l,E,d);for(let t=0;t<M.length;t+=1)M[t].m(E,null);O||(q=[_(r,"input",t[8]),_(s,"input",t[9])],O=!0)},p(t,e){2&e&&b(r.value)!==t[1]&&x(r,t[1]),16&e&&b(s.value)!==t[4]&&x(s,t[4]),1&e&&C!==(C=t[0].length+"")&&$(h,C),25&e&&(L=t[0].slice(0,t[4]),M=R(M,e,N,1,t,L,j,E,F,vt,null,ht))},d(t){t&&d(e),t&&d(w),t&&d(k),t&&d(S),t&&d(E);for(let t=0;t<M.length;t+=1)M[t].d();O=!1,l(q)}}}function _t(t){let e,n,o,l;return{c(){e=m("br"),n=y(),o=m("img"),s(o.src,l="https://images.weserv.nl/?w=96&il&url=https://orna.guide/static/orna/img/"+t[13].image)||v(o,"src",l),v(o,"alt",""),v(o,"loading","lazy"),v(o,"width","96"),v(o,"height","96"),v(o,"class","svelte-1x50ec1")},m(t,l){f(t,e,l),f(t,n,l),f(t,o,l)},p(t,e){17&e&&!s(o.src,l="https://images.weserv.nl/?w=96&il&url=https://orna.guide/static/orna/img/"+t[13].image)&&v(o,"src",l)},d(t){t&&d(e),t&&d(n),t&&d(o)}}}function vt(t,e){let n,o,l,r,i,u,c,s,a,h,_,b,x,w,k,S,E,O,q,C=e[13].id+"",M=e[13].name+"",j=e[13].tier+"",L=JSON.stringify({...e[13],context:null},null," ")+"",N=e[3]&&_t(e);return{key:t,first:null,c(){n=m("li"),o=m("details"),l=m("summary"),r=g(C),i=g(" - "),u=g(M),c=y(),s=m("sup"),a=g("T"),h=g(j),_=y(),b=m("a"),x=g("🔗"),k=y(),N&&N.c(),S=y(),E=m("pre"),O=g(L),q=y(),v(b,"href",w="https://orna.guide/items?show="+e[13].id),v(b,"target","orna.guide"),v(E,"class","item-pre svelte-1x50ec1"),v(n,"class","svelte-1x50ec1"),this.first=n},m(t,e){f(t,n,e),p(n,o),p(o,l),p(l,r),p(l,i),p(l,u),p(l,c),p(l,s),p(s,a),p(s,h),p(l,_),p(l,b),p(b,x),p(l,k),N&&N.m(l,null),p(o,S),p(o,E),p(E,O),p(n,q)},p(t,n){e=t,17&n&&C!==(C=e[13].id+"")&&$(r,C),17&n&&M!==(M=e[13].name+"")&&$(u,M),17&n&&j!==(j=e[13].tier+"")&&$(h,j),17&n&&w!==(w="https://orna.guide/items?show="+e[13].id)&&v(b,"href",w),e[3]?N?N.p(e,n):(N=_t(e),N.c(),N.m(l,null)):N&&(N.d(1),N=null),17&n&&L!==(L=JSON.stringify({...e[13],context:null},null," ")+"")&&$(O,L)},d(t){t&&d(n),N&&N.d()}}}function bt(t){let e,n,o,r,i,u,c,s,a,h,g,b,$,x,w,k,S,E=[],O=new Map,q=t[2];const C=t=>t[16].timestamp;for(let e=0;e<q.length;e+=1){let n=mt(t,q,e),o=C(n);O.set(o,E[e]=gt(o,n))}let M=t[0].length&&yt(t);return{c(){e=m("h1"),e.innerHTML='<a href="https://playorna.com/" target="_blank">Orna</a> items Lookup tool',n=y(),o=m("div"),r=m("aside"),i=m("button"),i.textContent="add new filter",u=y(),c=m("ul");for(let t=0;t<E.length;t+=1)E[t].c();s=y(),a=m("hr"),h=y(),M&&M.c(),g=y(),b=m("hr"),$=y(),x=m("footer"),x.innerHTML='* data &amp; image source: <a href="https://orna.guide/" target="_blank">https://orna.guide/</a>  <br/>\n  * repo: <a href="https://github.com/rplus/orna-lookup" target="_blank">Rplus/orna-lookup</a>',v(o,"class","workspace"),v(x,"class","svelte-1x50ec1")},m(l,d){f(l,e,d),f(l,n,d),f(l,o,d),p(o,r),p(r,i),p(r,u),p(r,c);for(let t=0;t<E.length;t+=1)E[t].m(c,null);p(o,s),p(o,a),p(o,h),M&&M.m(o,null),f(l,g,d),f(l,b,d),f(l,$,d),f(l,x,d),w=!0,k||(S=_(i,"click",t[5]),k=!0)},p(t,[e]){4&e&&(q=t[2],I={r:0,c:[],p:I},E=R(E,e,C,1,t,q,O,c,H,gt,null,mt),I.r||l(I.c),I=I.p),t[0].length?M?M.p(t,e):(M=yt(t),M.c(),M.m(o,null)):M&&(M.d(1),M=null)},i(t){if(!w){for(let t=0;t<q.length;t+=1)J(E[t]);w=!0}},o(t){for(let t=0;t<E.length;t+=1)D(E[t]);w=!1},d(t){t&&d(e),t&&d(n),t&&d(o);for(let t=0;t<E.length;t+=1)E[t].d();M&&M.d(),t&&d(g),t&&d(b),t&&d($),t&&d(x),k=!1,S()}}}function $t(t,e,n){let o,l,r,i,u;a(t,X,(t=>n(7,i=t))),a(t,Z,(t=>n(2,u=t)));let c=!1,s=[];function p(t){let e=i;return console.log("filterItems",t),!t||!t.length||1===t.length&&null==t[0].rules?.value||t.map((t=>t.rules)).forEach((t=>{t&&(e=function(t,e){let{prop:n,type:o,value:l,comparator:r}=e;if(!l||!t.length)return t;switch("string"==typeof l&&(l=l.toLowerCase()),"checkbox"===o&&(l=Boolean(+l)),o){case"checkbox":return l?t.filter((t=>t[n])):t.filter((t=>!t[n]));case"number":return t.filter((t=>{switch(r){case"+":return t[n]>=l;case"-":return t[n]<=l;default:return t[n]===l}}));case"text":let e=new RegExp(l,"i");return t.filter((t=>e.test(t[n])));default:return t}}(e,t))})),e}function f(){console.log("addFilter"),Z.add({timestamp:+new Date})}return f(),t.$$.update=()=>{192&t.$$.dirty&&(i.waiting||c||(n(6,c=!0),n(0,s=i))),5&t.$$.dirty&&(p(u),n(0,s=p(u)),console.log({items:s})),3&t.$$.dirty&&n(3,r=s.length<=l)},n(4,o=30),n(1,l=5),[s,l,u,r,o,f,c,i,function(){l=b(this.value),n(1,l)},function(){o=b(this.value),n(4,o)}]}return new class extends U{constructor(t){super(),Q(this,t,$t,bt,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
